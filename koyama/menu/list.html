<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¢ãƒ—ãƒªä¸€è¦§</title>

<style>
body {
    margin: 0;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Yu Gothic", sans-serif;
    background: #f5f5f7;
}
h2 {
    text-align: center;
    margin-bottom: 24px;
}
.app-list {
    list-style: none;
    padding: 0;
    max-width: 600px;
    margin: auto;
}
.app-card {
    background: #fff;
    border-radius: 16px;
    padding: 16px;
    margin-bottom: 16px;
    box-shadow: 0 4px 12px rgba(0,0,0,.05);
    display: flex;
    align-items: center;
    cursor: pointer;
    transition: transform .2s, opacity .2s;
}
.app-card:active {
    transform: scale(.97);
}
.app-card.disabled {
    opacity: .5;
    pointer-events: none;
}
.app-icon {
    font-size: 2.5rem;
    margin-right: 16px;
    width: 60px;
    text-align: center;
}
.app-title {
    font-weight: bold;
    margin: 0 0 4px;
}
.app-desc {
    font-size: .85rem;
    color: #666;
    margin: 0;
}
.lock {
    margin-left: auto;
    font-size: 1.2rem;
}
</style>
</head>

<body>

<h2>ã‚¢ãƒ—ãƒªä¸€è¦§</h2>
<ul id="appList" class="app-list"></ul>

<script>
/* ===== ã‚¢ãƒ—ãƒªå®šç¾©JSON ===== */
const appsConfig = [
  {
    id: "chat",
    icon: "ğŸ’¬",
    name: "ãƒãƒ£ãƒƒãƒˆ",
    description: "ç¸¦ç”»é¢å°‚ç”¨ãƒãƒ£ãƒƒãƒˆã€‚ã¿ã‚“ãªã§ä¼šè©±ã—ã‚ˆã†",
    url: "https://www3.cbox.ws/box/?boxid=3550995&boxtag=ymqqtx",
    orientation: "portrait",
    password: null,
    version: null,
    enabled: true
  },
  {
    id: "koyama",
    icon: "ğŸ”ï¸",
    name: "é€²æ’ƒã®å°å±±",
    description: "é™å®šå…¬é–‹ãƒ»æ¨ªç”»é¢å°‚ç”¨ã‚¢ã‚¯ã‚·ãƒ§ãƒ³",
    url: "https://riverteacher.github.io/ohhhhhn/koyama/game/",
    orientation: "landscape",
    password: "koyama2025",
    version: "3",
    enabled: true
  }
];

/* ===== Cookie ===== */
function setCookie(n, v, d) {
    const e = new Date(Date.now() + d*86400000).toUTCString();
    document.cookie = `${n}=${v};expires=${e};path=/`;
}
function getCookie(n) {
    const m = document.cookie.match(new RegExp('(^| )'+n+'=([^;]+)'));
    return m ? m[2] : null;
}
function deleteCookie(n) {
    document.cookie = n + "=;Max-Age=0;path=/";
}

/* ===== æç”» ===== */
const list = document.getElementById("appList");

appsConfig.forEach(app => {
    const li = document.createElement("li");
    li.className = "app-card" + (app.enabled ? "" : " disabled");
    li.innerHTML = `
        <div class="app-icon">${app.icon}</div>
        <div>
            <p class="app-title">${app.name}</p>
            <p class="app-desc">${app.description}</p>
        </div>
        ${app.password ? '<div class="lock">ğŸ”’</div>' : ""}
    `;
    li.onclick = () => launchApp(app);
    list.appendChild(li);
});

/* ===== èµ·å‹•å‡¦ç† ===== */
function launchApp(app) {
    if (!app.enabled) {
        alert("ã“ã®ã‚¢ãƒ—ãƒªã¯ç¾åœ¨åœæ­¢ä¸­ã§ã™");
        return;
    }

    if (app.password) {
        const key = `unlock_${app.id}`;
        const ver = `ver_${app.id}`;

        if (getCookie(key) && getCookie(ver) !== app.version) {
            deleteCookie(key);
            deleteCookie(ver);
        }

        if (!getCookie(key)) {
            const input = prompt("é™å®šã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã§ã™ã€‚\nãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");
            if (input !== app.password) {
                alert("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™");
                return;
            }
            setCookie(key, "true", 7);
            setCookie(ver, app.version, 7);
        }
    }

    checkOrientationAndLaunch(app.url, app.orientation);
}

/* ===== ç”»é¢å‘ã ===== */
function checkOrientationAndLaunch(url, orientation) {
    const isMobile = /Mobi|Android|iPhone/i.test(navigator.userAgent);
    const isLandscape = innerWidth > innerHeight;

    if (!isMobile) {
        location.href = url;
        return;
    }

    if (
        (orientation === "landscape" && isLandscape) ||
        (orientation === "portrait" && !isLandscape)
    ) {
        location.href = url;
    } else {
        alert(
            orientation === "landscape"
            ? "æ¨ªç”»é¢ã«ã—ã¦ãã ã•ã„"
            : "ç¸¦ç”»é¢ã«ã—ã¦ãã ã•ã„"
        );
    }
}
</script>

</body>
</html>
