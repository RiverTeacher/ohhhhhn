<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ã‚¢ãƒ—ãƒªä¸€è¦§</title>

<style>
/* ===== åŸºæœ¬ ===== */
body {
    margin: 0;
    padding: 20px;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Yu Gothic", sans-serif;
    background: #f5f5f7;
}
h2 {
    text-align: center;
    margin-bottom: 24px;
}

/* ===== ã‚«ãƒ¼ãƒ‰ ===== */
.app-list {
    list-style: none;
    padding: 0;
    max-width: 620px;
    margin: auto;
}
.app-card {
    background: #fff;
    border-radius: 18px;
    padding: 16px 18px;
    margin-bottom: 16px;
    box-shadow: 0 6px 16px rgba(0,0,0,.06);
    display: flex;
    align-items: center;
    gap: 16px;
    cursor: pointer;
    transition: transform .2s, opacity .2s;
}
.app-card:active {
    transform: scale(.97);
}
.app-card.disabled {
    opacity: .5;
    pointer-events: none;
}

.app-icon {
    font-size: 2.6rem;
    width: 56px;
    text-align: center;
}
.app-title {
    font-weight: 600;
    margin: 0 0 4px;
}
.app-desc {
    font-size: .85rem;
    color: #666;
    margin: 0;
}

/* ===== ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒãƒƒã‚¸ ===== */
.app-status {
    margin-left: auto;
    font-size: .75rem;
    font-weight: 600;
    padding: 6px 10px;
    border-radius: 999px;
    white-space: nowrap;
}

.status-locked {
    color: #c62828;
    background: #fdeaea;
}

.status-unlocked {
    color: #558b2f;
    background: #eef7e6;
}

.status-disabled {
    color: #757575;
    background: #eeeeee;
}

/* ===== ãƒ¢ãƒ¼ãƒ€ãƒ« ===== */
.modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,.4);
    display: none;
    align-items: center;
    justify-content: center;
    z-index: 1000;
}
.modal.active {
    display: flex;
}
.modal-box {
    background: #fff;
    border-radius: 20px;
    width: 90%;
    max-width: 340px;
    padding: 24px;
    text-align: center;
    box-shadow: 0 10px 30px rgba(0,0,0,.25);
    animation: pop .25s ease;
}
@keyframes pop {
    from { transform: scale(.9); opacity: 0 }
    to   { transform: scale(1); opacity: 1 }
}
.modal-title {
    font-weight: 600;
    margin-bottom: 12px;
}
.modal-input {
    width: 100%;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid #ccc;
    font-size: 1rem;
    margin-bottom: 12px;
}
.modal-error {
    color: #c62828;
    font-size: .8rem;
    margin-bottom: 10px;
    display: none;
}
.modal-buttons {
    display: flex;
    gap: 10px;
}
.modal-btn {
    flex: 1;
    border: none;
    padding: 10px;
    border-radius: 10px;
    font-weight: 600;
    cursor: pointer;
}
.btn-cancel {
    background: #eee;
}
.btn-ok {
    background: #007bff;
    color: #fff;
}
</style>
</head>

<body>

<h2>ã‚¢ãƒ—ãƒªä¸€è¦§</h2>
<ul id="appList" class="app-list"></ul>

<!-- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒ¢ãƒ¼ãƒ€ãƒ« -->
<div id="passwordModal" class="modal">
  <div class="modal-box">
    <div class="modal-title">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›</div>
    <input id="passwordInput" type="password" class="modal-input" placeholder="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰">
    <div id="passwordError" class="modal-error">ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒé•ã„ã¾ã™</div>
    <div class="modal-buttons">
      <button class="modal-btn btn-cancel" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      <button class="modal-btn btn-ok" onclick="submitPassword()">è§£ç¦</button>
    </div>
  </div>
</div>

<script>
/* ===== ã‚¢ãƒ—ãƒªå®šç¾© ===== */
const appsConfig = [
  {
    id: "chat",
    icon: "ğŸ’¬",
    name: "ãƒãƒ£ãƒƒãƒˆ",
    description: "ç¸¦ç”»é¢å°‚ç”¨ãƒãƒ£ãƒƒãƒˆ",
    url: "https://www3.cbox.ws/box/?boxid=3550995&boxtag=ymqqtx",
    orientation: "portrait",
    password: null,
    version: null,
    enabled: false
  },
  {
    id: "koyama",
    icon: "ğŸ”ï¸",
    name: "é€²æ’ƒã®å°å±±",
    description: "ç„¡é™ã«è¿«ã£ã¦ãã‚‹å°å±±ã‚’ãƒ‘ãƒ³ãƒã‚„ãƒ“ãƒ¼ãƒ ã‚’ä½¿ã£ã¦å€’ã™ã‚²ãƒ¼ãƒ ã§ã™",
    url: "https://riverteacher.github.io/ohhhhhn/koyama/game/",
    orientation: "landscape",
    password: "koyama2025",
    version: "3",
    enabled: true
  }
];

/* ===== Cookie ===== */
const setC = (n,v,d)=>document.cookie=`${n}=${v};expires=${new Date(Date.now()+d*864e5).toUTCString()};path=/`;
const getC = n => (document.cookie.match(new RegExp('(^| )'+n+'=([^;]+)'))||[])[2];
const delC = n => document.cookie=`${n}=;Max-Age=0;path=/`;

/* ===== æç”» ===== */
const list = document.getElementById("appList");

function render() {
    list.innerHTML = "";
    appsConfig.forEach(app => {
        const u = `unlock_${app.id}`;
        const v = `ver_${app.id}`;
        if (getC(u) && getC(v) !== app.version) {
            delC(u); delC(v);
        }

        let status, cls;
        if (!app.enabled) {
            status = "ã‚¢ãƒ—ãƒªä½¿ç”¨ä¸å¯"; cls = "status-disabled";
        } else if (app.password && !getC(u)) {
            status = "ãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™"; cls = "status-locked";
        } else {
            status = "è§£æ”¾æ¸ˆ"; cls = "status-unlocked";
        }

        const li = document.createElement("li");
        li.className = "app-card" + (app.enabled ? "" : " disabled");
        li.innerHTML = `
            <div class="app-icon">${app.icon}</div>
            <div>
                <p class="app-title">${app.name}</p>
                <p class="app-desc">${app.description}</p>
            </div>
            <div class="app-status ${cls}">${status}</div>
        `;
        li.onclick = () => launchApp(app);
        list.appendChild(li);
    });
}

/* ===== èµ·å‹• ===== */
let currentApp = null;

function launchApp(app) {
    if (!app.enabled) return;

    if (app.password && !getC(`unlock_${app.id}`)) {
        currentApp = app;
        openModal();
        return;
    }
    openApp(app);
}

function openApp(app) {
    const isMobile = /Mobi|Android|iPhone/i.test(navigator.userAgent);
    const isLandscape = innerWidth > innerHeight;
    if (!isMobile ||
        (app.orientation === "landscape" && isLandscape) ||
        (app.orientation === "portrait" && !isLandscape)) {
        location.href = app.url;
    } else {
        alert(app.orientation === "landscape" ? "æ¨ªç”»é¢ã«ã—ã¦ãã ã•ã„" : "ç¸¦ç”»é¢ã«ã—ã¦ãã ã•ã„");
    }
}

/* ===== ãƒ¢ãƒ¼ãƒ€ãƒ« ===== */
const modal = document.getElementById("passwordModal");
const input = document.getElementById("passwordInput");
const error = document.getElementById("passwordError");

function openModal() {
    input.value = "";
    error.style.display = "none";
    modal.classList.add("active");
    input.focus();
}
function closeModal() {
    modal.classList.remove("active");
}
function submitPassword() {
    if (input.value === currentApp.password) {
        setC(`unlock_${currentApp.id}`, "true", 7);
        setC(`ver_${currentApp.id}`, currentApp.version, 7);
        closeModal();
        render();
        openApp(currentApp);
    } else {
        error.style.display = "block";
    }
}

render();
</script>

</body>
</html>
